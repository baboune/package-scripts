name:    "python"
version: "2.7.5"

sources [
  { url: "https://apcera-sources.s3.amazonaws.com/python/Python-2.7.6.tgz",
    sha256: "99c6860b70977befa1590029fae092ddb18db1d69ae67e8b9385b66ed104ba58" },
  { url: "https://apcera-sources.s3.amazonaws.com/python/pip-1.5.2.tar.gz",
    sha256: "2a8a3e08e652d3a40edbb39264bf01f8ff3c32520a79113357cca1f30533f738" },
  { url: "https://apcera-sources.s3.amazonaws.com/python/distribute-0.6.49.tar.gz",
    sha256: "b877a9f155fc13cbf409d4fdbf709d25c24f28dfe3531ecb419eb069bd80e878" },
  { url: "https://apcera-sources.s3.amazonaws.com/python/virtualenv-1.11.2.tar.gz",
    sha256: "3080a1610fa8c4ab23008707ca5c96d7e67d8cb3ed98c7e01e97f542c82bb6df" },
]

build_depends [ { package: "build-essential" } ]
depends       [ { os: "linux" } ]
provides      [ { runtime: "python" },
                { runtime: "python-2.7" },
                { runtime: "python-2.7.6" } ]

# _PYTHONPATH is the python include dir.
# _PYTHONHOME is the base dir for python.
# _C_INCLUDE_PATH is for C code that requires imports.
# These are provided to make it easy for people to use in other package scripts.
# We use _ variants of the ENV variable names to prevent staging issues
# due to bad permissions in /opt.
environment {            "PATH": "/opt/apcera/python-2.7.6/bin:$PATH",
                  "_PYTHONHOME": "/opt/apcera/python-2.7.6",
                  "_PYTHONPATH": "/opt/apcera/python-2.7.6/include/python2.7:$_PYTHONPATH",
              "_C_INCLUDE_PATH": "/opt/apcera/python-2.7.6/include/python2.7:$_C_INCLUDE_PATH" }

cleanup [ "/usr/lib/python2.7" ] # this will come from it using python
                                 # it will generate *.pyc files

build (
      export INSTALLPATH=/opt/apcera/python-2.7.6

      tar xzvf Python-2.7.6.tgz
      tar xzvf pip-1.5.2.tar.gz
      tar xzvf distribute-0.6.49.tar.gz
      tar xzvf virtualenv-1.11.2.tar.gz

      (
        cd Python-2.7.6
        ./configure --prefix=${INSTALLPATH}
        make
        sudo make install
      )

      (
        cd distribute-0.6.49
        sudo ${INSTALLPATH}/bin/python -s setup.py --no-user-cfg install --force --verbose
      )

      (
        cd pip-1.5.2
        sudo ${INSTALLPATH}/bin/python -s setup.py --no-user-cfg install --force --verbose
      )

      (
        cd virtualenv-1.11.2
        sudo ${INSTALLPATH}/bin/python -s setup.py --no-user-cfg install --force --verbose
      )
)
